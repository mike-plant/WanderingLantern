---
layout: layouts/base.njk
title: Purchase Orders
eleventyExcludeFromCollections: true
permalink: /orders/index.html
---

<div class="orders-container">
    <!-- Sign In Screen -->
    <div id="signin-screen" class="signin-screen">
        <div class="signin-box">
            <h1>Purchase Orders</h1>
            <p class="signin-tagline">Internal order management system</p>
            <button id="signin-button" class="btn-signin">
                <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z" fill="#4285F4"/>
                    <path d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z" fill="#34A853"/>
                    <path d="M3.964 10.71c-.18-.54-.282-1.117-.282-1.71s.102-1.17.282-1.71V4.958H.957C.347 6.173 0 7.548 0 9s.348 2.827.957 4.042l3.007-2.332z" fill="#FBBC05"/>
                    <path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z" fill="#EA4335"/>
                </svg>
                Sign in with Google
            </button>
            <p class="signin-note">You must sign in with your authorized Google account to access this system.</p>
        </div>
    </div>

    <!-- Main App (hidden until signed in) -->
    <div id="main-app" class="main-app" style="display: none;">
        <!-- Header -->
        <header class="orders-header">
            <div class="header-content">
                <div class="header-left">
                    <h1>Purchase Orders</h1>
                    <div class="user-info">
                        Signed in as: <span id="user-email"></span>
                        <button id="signout-button" class="btn-text">Sign Out</button>
                    </div>
                </div>
                <div class="header-right">
                    <button id="new-order-button" class="btn-primary">+ New Order</button>
                    <button id="refresh-button" class="btn-secondary">â†» Refresh</button>
                </div>
            </div>
        </header>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-button active" data-tab="orders">Customer Orders</button>
            <button class="tab-button" data-tab="inventory">Inventory</button>
        </div>

        <!-- Orders Tab -->
        <div id="orders-tab" class="tab-content active">
        <!-- Filters & Stats -->
        <div class="filters-bar">
            <div class="stats">
                <div class="stat-badge">
                    <span class="stat-label">Total Orders:</span>
                    <span id="stat-total" class="stat-value">0</span>
                </div>
                <div class="stat-badge urgent">
                    <span class="stat-label">Urgent:</span>
                    <span id="stat-urgent" class="stat-value">0</span>
                </div>
                <div class="stat-badge pending">
                    <span class="stat-label">Pending Action:</span>
                    <span id="stat-pending" class="stat-value">0</span>
                </div>
            </div>

            <div class="filters">
                <input type="text" id="search-input" placeholder="Search orders..." class="search-input">

                <select id="status-filter" class="filter-select">
                    <option value="">All Statuses</option>
                    <option value="Requested">Requested</option>
                    <option value="Sourced">Sourced</option>
                    <option value="Ordered">Ordered</option>
                    <option value="Arrived">Arrived</option>
                    <option value="Notified">Notified</option>
                    <option value="Picked Up">Picked Up</option>
                    <option value="Cancelled">Cancelled</option>
                </select>

                <select id="supplier-filter" class="filter-select">
                    <option value="">All Suppliers</option>
                    <option value="Faire">Faire</option>
                    <option value="Ingram">Ingram</option>
                    <option value="WorldBooks">WorldBooks</option>
                    <option value="Other">Other</option>
                </select>

                <button id="clear-filters" class="btn-text">Clear Filters</button>
            </div>
        </div>

        <!-- Orders Table -->
        <div class="orders-table-container">
            <table class="orders-table">
                <thead>
                    <tr>
                        <th data-sort="orderId">ID</th>
                        <th data-sort="status">Status</th>
                        <th data-sort="customerName">Customer</th>
                        <th data-sort="bookTitle">Book</th>
                        <th data-sort="neededBy">Needed By</th>
                        <th data-sort="preferredSupplier">Supplier</th>
                        <th data-sort="requestDate">Requested</th>
                        <th class="actions-column">Actions</th>
                    </tr>
                </thead>
                <tbody id="orders-tbody">
                    <tr class="loading-row">
                        <td colspan="8">Loading orders...</td>
                    </tr>
                </tbody>
            </table>

            <div id="empty-state" class="empty-state" style="display: none;">
                <p>No orders found.</p>
                <button class="btn-primary" onclick="document.getElementById('new-order-button').click()">Create First Order</button>
            </div>
        </div>
        </div>
        <!-- End Orders Tab -->

        <!-- Inventory Tab -->
        <div id="inventory-tab" class="tab-content" style="display: none;">
            <div class="inventory-container">
                <!-- Import Section -->
                <div class="inventory-section">
                    <h2>Import Ingram Order</h2>
                    <p class="section-description">Paste the text from your Ingram order confirmation email below:</p>
                    <textarea id="ingram-import-text" class="ingram-import-textarea" placeholder="Paste Ingram order confirmation here..." rows="15"></textarea>
                    <button id="import-ingram-button" class="btn-primary">Parse & Import Order</button>
                    <div id="import-status" class="import-status" style="display: none;"></div>
                </div>

                <!-- Search Section -->
                <div class="inventory-section">
                    <h2>Search Inventory</h2>
                    <p class="section-description">Search for books across all imported shipments:</p>
                    <input type="text" id="inventory-search" class="search-input" placeholder="Search by title, author, or ISBN...">
                    <div id="inventory-search-results" class="inventory-results"></div>
                </div>

                <!-- Receiving Section -->
                <div class="inventory-section">
                    <h2>Receive Shipments</h2>
                    <p class="section-description">Check off books as you receive them:</p>
                    <div class="receiving-filters">
                        <select id="po-filter" class="filter-select">
                            <option value="">All POs</option>
                        </select>
                        <select id="shipment-status-filter" class="filter-select">
                            <option value="Shipped">Shipped (not received)</option>
                            <option value="InStock">Received</option>
                            <option value="">All</option>
                        </select>
                    </div>
                    <div id="receiving-list" class="receiving-list"></div>
                </div>

                <!-- Export Section -->
                <div class="inventory-section">
                    <h2>Export to Shopify</h2>
                    <p class="section-description">Export received books as Shopify CSV:</p>
                    <button id="export-shopify-button" class="btn-primary">Export Received Books to CSV</button>
                    <div id="export-stats" class="export-stats" style="display: none;"></div>
                </div>
            </div>
        </div>
        <!-- End Inventory Tab -->
    </div>

    <!-- Modal: New/Edit Order -->
    <div id="order-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">New Order</h2>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>

            <form id="order-form" class="order-form">
                <input type="hidden" id="edit-order-id">

                <fieldset>
                    <legend>Customer Information</legend>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="customer-name">Customer Name *</label>
                            <input type="text" id="customer-name" required>
                        </div>

                        <div class="form-group">
                            <label for="customer-phone">Phone *</label>
                            <input type="tel" id="customer-phone" required placeholder="(216) 555-1234">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="customer-email">Email</label>
                        <input type="email" id="customer-email" placeholder="optional">
                    </div>
                </fieldset>

                <fieldset>
                    <legend>Book Information</legend>

                    <div class="form-group">
                        <label for="book-title">Book Title *</label>
                        <input type="text" id="book-title" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="book-author">Author</label>
                            <input type="text" id="book-author">
                        </div>

                        <div class="form-group">
                            <label for="book-isbn">ISBN</label>
                            <input type="text" id="book-isbn" placeholder="if known">
                        </div>
                    </div>
                </fieldset>

                <fieldset>
                    <legend>Order Details</legend>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="needed-by">Needed By *</label>
                            <input type="date" id="needed-by" required>
                        </div>

                        <div class="form-group">
                            <label for="status">Status</label>
                            <select id="status">
                                <option value="Requested">Requested</option>
                                <option value="Sourced">Sourced</option>
                                <option value="Ordered">Ordered</option>
                                <option value="Arrived">Arrived</option>
                                <option value="Notified">Notified</option>
                                <option value="Picked Up">Picked Up</option>
                                <option value="Cancelled">Cancelled</option>
                            </select>
                        </div>
                    </div>

                    <div class="supplier-recommendation" id="supplier-recommendation" style="display: none;">
                        <strong>Recommended:</strong> <span id="recommended-supplier"></span>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="preferred-supplier">Preferred Supplier</label>
                            <select id="preferred-supplier">
                                <option value="">Not yet determined</option>
                                <option value="Faire">Faire (50% discount, 1-2 weeks)</option>
                                <option value="Ingram">Ingram (40% discount, 3-5 days)</option>
                                <option value="WorldBooks">WorldBooks (used/rare)</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="actual-supplier">Actual Supplier Used</label>
                            <select id="actual-supplier">
                                <option value="">Not ordered yet</option>
                                <option value="Faire">Faire</option>
                                <option value="Ingram">Ingram</option>
                                <option value="WorldBooks">WorldBooks</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="order-date">Order Date</label>
                            <input type="date" id="order-date">
                        </div>

                        <div class="form-group">
                            <label for="cost">Cost</label>
                            <input type="number" id="cost" step="0.01" placeholder="0.00">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="tracking-info">Tracking Info</label>
                        <input type="text" id="tracking-info" placeholder="Tracking number or delivery notes">
                    </div>

                    <div class="form-group">
                        <label for="notes">Notes</label>
                        <textarea id="notes" rows="3" placeholder="Special requests, pricing notes, etc."></textarea>
                    </div>
                </fieldset>

                <div class="modal-footer">
                    <button type="button" class="btn-secondary" id="cancel-button">Cancel</button>
                    <button type="submit" class="btn-primary">Save Order</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Load the orders app -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://apis.google.com/js/api.js" async defer></script>
<script src="/assets/js/orders-app.js"></script>
